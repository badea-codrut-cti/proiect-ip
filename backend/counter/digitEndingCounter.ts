import { numberToKana } from './numberToKana';

export const digitEndingCounters = {
  "本": {
    "0": "っぽん",  // suffix for 10, 20, 30...
    "1": "いっぽん",
    "2": "にほん",
    "3": "さんぼん",
    "4": "よんほん",
    "5": "ごほん",
    "6": "ろっぽん",
    "7": "ななほん",
    "8": "はっぽん",
    "9": "きゅうほん"
  },
  "匹": {
    "0": "っぴき",
    "1": "いっぴき",
    "2": "にひき",
    "3": "さんびき",
    "4": "よんひき",
    "5": "ごひき",
    "6": "ろっぴき",
    "7": "ななひき",
    "8": "はっぴき",
    "9": "きゅうひき"
  },
  "個": {
    "0": "っこ",
    "1": "いっこ",
    "2": "にこ",
    "3": "さんこ",
    "4": "よんこ",
    "5": "ごこ",
    "6": "ろっこ",
    "7": "ななこ",
    "8": "はっこ",
    "9": "きゅうこ"
  },
  "杯": {
    "0": "っぱい",
    "1": "いっぱい",
    "2": "にはい",
    "3": "さんばい",
    "4": "よんはい",
    "5": "ごはい",
    "6": "ろっぱい",
    "7": "ななはい",
    "8": "はっぱい",
    "9": "きゅうはい"
  },
  "冊": {
    "0": "っさつ",
    "1": "いっさつ",
    "2": "にさつ",
    "3": "さんさつ",
    "4": "よんさつ",
    "5": "ごさつ",
    "6": "ろくさつ",
    "7": "ななさつ",
    "8": "はっさつ",
    "9": "きゅうさつ"
  },
  "枚": {
    "0": "まい",
    "1": "いちまい",
    "2": "にまい",
    "3": "さんまい",
    "4": "よんまい",
    "5": "ごまい",
    "6": "ろくまい",
    "7": "ななまい",
    "8": "はちまい",
    "9": "きゅうまい"
  },
  "台": {
    "0": "だい",
    "1": "いちだい",
    "2": "にだい",
    "3": "さんだい",
    "4": "よんだい",
    "5": "ごだい",
    "6": "ろくだい",
    "7": "ななだい",
    "8": "はちだい",
    "9": "きゅうだい"
  },
  "回": {
    "0": "っかい",
    "1": "いっかい",
    "2": "にかい",
    "3": "さんかい",
    "4": "よんかい",
    "5": "ごかい",
    "6": "ろっかい",
    "7": "ななかい",
    "8": "はっかい",
    "9": "きゅうかい"
  },
  "足": {
    "0": "っそく",
    "1": "いっそく",
    "2": "にそく",
    "3": "さんぞく",
    "4": "よんそく",
    "5": "ごそく",
    "6": "ろくそく",
    "7": "ななそく",
    "8": "はっそく",
    "9": "きゅうそく"
  },
  "着": {
    "0": "っちゃく",
    "1": "いっちゃく",
    "2": "にちゃく",
    "3": "さんちゃく",
    "4": "よんちゃく",
    "5": "ごちゃく",
    "6": "ろくちゃく",
    "7": "ななちゃく",
    "8": "はっちゃく",
    "9": "きゅうちゃく"
  },
  "羽": {
    "0": "っぱ",
    "1": "いちわ",
    "2": "にわ",
    "3": "さんば",
    "4": "よんわ",
    "5": "ごわ",
    "6": "ろっぱ",
    "7": "ななわ",
    "8": "はちわ",
    "9": "きゅうわ"
  },
  "頭": {
    "0": "っとう",
    "1": "いっとう",
    "2": "にとう",
    "3": "さんとう",
    "4": "よんとう",
    "5": "ごとう",
    "6": "ろくとう",
    "7": "ななとう",
    "8": "はっとう",
    "9": "きゅうとう"
  },
  "軒": {
    "0": "っけん",
    "1": "いっけん",
    "2": "にけん",
    "3": "さんげん",
    "4": "よんけん",
    "5": "ごけん",
    "6": "ろっけん",
    "7": "ななけん",
    "8": "はっけん",
    "9": "きゅうけん"
  },
  "階": {
    "0": "っかい",
    "1": "いっかい",
    "2": "にかい",
    "3": "さんがい",
    "4": "よんかい",
    "5": "ごかい",
    "6": "ろっかい",
    "7": "ななかい",
    "8": "はっかい",
    "9": "きゅうかい"
  },
  "分": {
    "0": "っぷん",
    "1": "いっぷん",
    "2": "にふん",
    "3": "さんぷん",
    "4": "よんぷん",
    "5": "ごふん",
    "6": "ろっぷん",
    "7": "ななふん",
    "8": "はっぷん",
    "9": "きゅうふん"
  },
  "時間": {
    "0": "じかん",
    "1": "いちじかん",
    "2": "にじかん",
    "3": "さんじかん",
    "4": "よじかん",
    "5": "ごじかん",
    "6": "ろくじかん",
    "7": "ななじかん",
    "8": "はちじかん",
    "9": "きゅうじかん"
  },
  "缶": {
    "0": "っかん",
    "1": "いっかん",
    "2": "にかん",
    "3": "さんかん",
    "4": "よんかん",
    "5": "ごかん",
    "6": "ろっかん",
    "7": "ななかん",
    "8": "はっかん",
    "9": "きゅうかん"
  },
  "皿": {
    "0": "さら",
    "1": "いちさら",
    "2": "にさら",
    "3": "さんさら",
    "4": "よんさら",
    "5": "ごさら",
    "6": "ろくさら",
    "7": "ななさら",
    "8": "はちさら",
    "9": "きゅうさら"
  },
  "週間": {
    "0": "っしゅうかん",
    "1": "いっしゅうかん",
    "2": "にしゅうかん",
    "3": "さんしゅうかん",
    "4": "よんしゅうかん",
    "5": "ごしゅうかん",
    "6": "ろくしゅうかん",
    "7": "ななしゅうかん",
    "8": "はっしゅうかん",
    "9": "きゅうしゅうかん"
  },
  "ヶ月": {
    "0": "っかげつ",
    "1": "いっかげつ",
    "2": "にかげつ",
    "3": "さんかげつ",
    "4": "よんかげつ",
    "5": "ごかげつ",
    "6": "ろっかげつ",
    "7": "ななかげつ",
    "8": "はっかげつ",
    "9": "きゅうかげつ"
  },
  "年": {
    "0": "ねん",
    "1": "いちねん",
    "2": "にねん",
    "3": "さんねん",
    "4": "よねん",
    "5": "ごねん",
    "6": "ろくねん",
    "7": "ななねん",
    "8": "はちねん",
    "9": "きゅうねん"
  },
  "円": {
    "0": "えん",
    "1": "いちえん",
    "2": "にえん",
    "3": "さんえん",
    "4": "よえん",
    "5": "ごえん",
    "6": "ろくえん",
    "7": "ななえん",
    "8": "はちえん",
    "9": "きゅうえん"
  },
  "時": {
    "0": "じ",
    "1": "いちじ",
    "2": "にじ",
    "3": "さんじ",
    "4": "よじ",
    "5": "ごじ",
    "6": "ろくじ",
    "7": "しちじ",
    "8": "はちじ",
    "9": "くじ"
  }
};

export function digitEndingCounterToKana(counter: string, number: number | string): string {
  const counterMap = digitEndingCounters[counter];
  
  if (!counterMap) {
    throw new Error(`Counter "${counter}" is not a digit-ending counter`);
  }
  
  const numericString = typeof number === 'number' ? number.toString() : number;
  
  if (numericString.includes('.')) {
    throw new Error('Digit-ending counters do not support decimals');
  }
  
  const numValue = parseInt(numericString, 10);
  
  if (numValue < 0) {
    throw new Error('Number must be non-negative');
  }
  
  const lastDigit = numValue % 10;
  
  // Direct lookup for 1-10
  if (numValue <= 10) {
    if (numValue === 10) {
      return 'じゅう' + counterMap["0"];
    }
    return counterMap[lastDigit.toString()];
  }
  
  // For 11+: prefix + counter reading for last digit
  const allButLastDigit = numValue - lastDigit;
  const prefixKana = numberToKana(allButLastDigit);
  
  if (lastDigit === 0) {
    // e.g., 20本 = にじゅう + っぽん
    return prefixKana + counterMap["0"];
  } else {
    // e.g., 23本 = にじゅう + さんぼん
    return prefixKana + counterMap[lastDigit.toString()];
  }
}

